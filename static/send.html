<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Send | Web-Alert</title>

    <link rel="stylesheet" href="stylesheets/main.css">

    <script type="text/javascript">
        window.addEventListener("load", function () {
            let ws = new WebSocket("ws://localhost:8080/socket")

            ws.onopen = function () {
                ws.send("Hello there!")
                alert("Message is sent...")
            }

            ws.onmessage = function (evt) {
                let received_msg = evt.data
                alert(`Received message: ${received_msg}`)
            }

            ws.onclose = function () {
                alert("Connection is closed...")
            }

            // Access the form element...
            const form = document.forms['message-input'];

            const messageList = document.getElementById("messages")

            // ...and take over its submit event.
            form.addEventListener("submit", function (event) {
                event.preventDefault();

                sendData(form.elements.message.value);
            });

            function sendData(message) {
                ws.send(message)

                const newMessageElement = document.createElement("li")
                newMessageElement.innerHTML = "message: " + message
                messageList.appendChild(newMessageElement)
            }
        });
    </script>
</head>
<body>
<div class="columns body">
    <form name="message-input" class="message-input columns grow bottom">
        <label for="message">Nachricht:</label>
        <input name="message" type="text" class="input grow">

        <input type="submit" value="Senden" class="button">
    </form>
    <div class="messages">
        <ul id="messages"></ul>
    </div>
</div>
</body>
</html>