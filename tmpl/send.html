<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Send | Web-Alert</title>

    <script type="text/javascript">
        window.addEventListener("load", function () {
            let ws = new WebSocket("ws://localhost:8080/socket")

            ws.onopen = function () {
                ws.send("Hello there!")
                alert("Message is sent...")
            }

            ws.onmessage = function (evt) {
                let received_msg = evt.data
                alert(`Received message: ${received_msg}`)
            }

            ws.onclose = function () {
                alert("Connection is closed...")
            }

            // Access the form element...
            const form = document.forms['message-input'];

            const messageList = document.getElementById("messages")

            // ...and take over its submit event.
            form.addEventListener("submit", function (event) {
                event.preventDefault();

                sendData(form.elements.message.value);
            });

            function sendData(message) {
                ws.send(message)

                const newMessageElement = document.createElement("li")
                newMessageElement.innerHTML = "message: " + message
                messageList.appendChild(newMessageElement)
            }
        });
    </script>

    <style>
        .messages {
            overflow-y: scroll;
            height: available;
        }

        .input {
            position: absolute;
            bottom: 0;
        }
    </style>
</head>
<body>
<div class="messages">
    <ul id="messages"></ul>
</div>
<form name="message-input" class="input">
    <label>
        Nachricht: <input name="message" type="text">
    </label>
    <input type="submit" value="Senden">
</form>
</body>
</html>